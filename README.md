# windows-customUserProfileTool
特定のユーザプロファイルをWindowsのデフォルトユーザプロファイルとして利用できるようにし、カスタマイズされたデスクトップやブラウザブックマークなどの情報を新規アカウント作成時にも展開されるようにするためのスクリプトです。

## ダウンロード
GitHubのダウンロード機能を用いるか、ソースコードのRawデータをコピーしてローカル環境に保存してください。

## 使用前の準備
### PowerShellスクリプト実行にかかわる一般的な事項
Poswershellスクリプト（以下PSスクリプト）は、署名されたスクリプト以外を実行しないようにする設定がWindowsにされています。このスクリプトをダウンロードして実行する前に、PowerShellを開いた状態で以下のコマンドを実行する必要があります。
```
Set-ExecutionPolicy -Scope Process -ExecutionPolicy Unrestricted
```
PSスクリプト実行のポリシーを、**現在のプロセスのみ**において（すなわち、一度PSウィンドウを閉じると元に戻る）**すべて実行許可**の状態にセットします。
これの既定値は「Restricted（すべて実行しない）」です。

### テンプレートとなるユーザの作成および構成
このPSスクリプトは、すでに存在しているユーザのデータを新規作成アカウントの規定値となるようにするものです。スクリプト実行前に、あらかじめ準備しておく必要があります。
> [!IMPORTANT]
> スクリプト上では「利用者テンプレート」というユーザ名のアカウントを既定としてみなすように動作します。別のユーザ名を指定する場合は、スクリプト8行目の該当箇所を変更します。

## 使い方
1. スクリプトをダウンロードして、適当な場所に保存します。
 > [!TIP]
 > 可能であればCドライブ直下に保存します。
2. 管理者権限でPoswerShellを起動します。
3. PSスクリプトを保存したディレクトリに移動します。
4. 実行ポリシーを変更します
```
Set-ExecutionPolicy -Scope Process -ExecutionPolicy Unrestricted
```
5. PSスクリプトを実行します。
```
.\userProfileCopy.ps1
```
6. しばらく待つと完了します。

## トラブルシューティング
### テンプレートユーザプロファイルが見つかりません。
- スクリプト既定のユーザアカウントを作成しましたか？
- 既定のアカウントのユーザ名に合った名前をスクリプトに指定しましたか？

### すでにWindows Defaultのユーザプロファイルが退避されています。フォルダの状態を確認して再実行してください。
`C:\Users\Default.bk`のフォルダーが作成されています。

### Windows Defaultユーザのプロファイルが見つかりません。フォルダの状態を確認して再実行してください。

